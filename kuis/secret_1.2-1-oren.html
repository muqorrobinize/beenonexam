<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Ujian Interaktif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(to bottom, #ff7e5f, #feb47b); /* Sunset gradient */
            color: #FFFFFF;
            text-shadow: 2px 2px #000000;
            overflow: hidden;
        }
        .pixel-border {
            border: 4px solid #000;
            box-shadow: 
                inset -4px -4px 0px 0px #000000,
                4px 4px 0px 0px #000000;
        }
        .quiz-card {
            background-color: #fca444; /* Mario Orange-Yellow */
            border-color: #98480c;
        }
        .option-btn {
            background-color: #d85020; /* Brick Red */
            border: 4px solid #000;
            box-shadow: inset -4px -4px 0px 0px #8c2800;
            transition: all 0.1s ease-in-out;
        }
        .option-btn:hover {
            background-color: #e06030;
        }
        .option-btn:active {
            box-shadow: inset 4px 4px 0px 0px #8c2800;
            transform: translateY(2px);
        }
        .option-btn.correct {
            background-color: #50d850; /* Green Pipe */
            box-shadow: inset -4px -4px 0px 0px #008c00;
        }
        .option-btn.incorrect {
            background-color: #d83838; /* Red Shell */
            box-shadow: inset -4px -4px 0px 0px #8c0000;
            opacity: 0.7;
        }
        .disabled {
            pointer-events: none;
        }
        .screen {
             animation: screenFadeIn 0.5s ease-in-out forwards;
        }
        .question-transition-out {
            animation: questionFadeOut 0.3s ease-in-out forwards;
        }
        .question-transition-in {
             animation: questionFadeIn 0.3s ease-in-out forwards;
        }
        @keyframes screenFadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes questionFadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(20px); }
        }
        @keyframes questionFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .action-btn {
            background-color: #50d850;
            box-shadow: inset -6px -6px 0px 0px #008c00;
        }
        .action-btn:hover {
             background-color: #60e060;
        }
        .action-btn:active {
            box-shadow: inset 6px 6px 0px 0px #008c00;
        }
        .surrender-btn {
            background-color: #d83838; /* Red Shell */
            box-shadow: inset -4px -4px 0px 0px #8c0000;
            border: 2px solid #000;
        }
        .surrender-btn:hover {
            background-color: #e04848;
        }
        .surrender-btn:active {
            box-shadow: inset 4px 4px 0px 0px #8c0000;
        }
        /* Custom styles for text input */
        #name-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
            text-shadow: 1px 1px #000000;
        }
        #name-input {
            text-shadow: 2px 2px #000000;
        }
    </style>
</head>
<body class="text-white">

    <div id="app" class="container mx-auto p-4 min-h-screen flex flex-col justify-center items-center">
        
        <!-- Start Screen -->
        <div id="start-screen" class="screen text-center p-8 rounded-lg max-w-lg w-full">
            <h1 class="text-4xl mb-4 leading-tight">Uji Pengetahuan</h1>
            <p class="text-sm text-white mb-8">Blok 1.3 - Edisi Pixel</p>
            <input type="text" id="name-input" placeholder="Masukkan Nama..." class="w-full p-4 mb-6 text-center bg-black/20 rounded-lg text-lg pixel-border focus:outline-none">
            <p class="mb-8 text-sm leading-relaxed">Selesaikan semua pertanyaan dalam 1 jam. Semoga berhasil!</p>
            <button id="start-btn" class="w-full action-btn text-white font-bold py-4 px-8 rounded-lg text-xl pixel-border">
                Mulai!
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden w-full max-w-4xl">
            <header class="mb-4 p-4 rounded-lg pixel-border bg-[#d85020]">
                <div class="flex justify-between items-center text-md flex-wrap gap-4">
                    <p>Soal <span id="current-question-num">1</span>/<span id="total-questions">65</span></p>
                    <p class="font-bold text-yellow-300">Skor: <span id="score">0</span></p>
                    <p class="font-bold">Waktu: <span id="quiz-timer">60:00</span></p>
                    <button id="surrender-btn" class="surrender-btn text-white font-bold py-1 px-3 rounded-lg text-xs">Menyerah</button>
                </div>
                <div class="w-full bg-black/50 rounded-full h-4 mt-2 pixel-border p-1">
                    <div id="progress-bar" class="bg-blue-500 h-full rounded-sm" style="width: 0%; transition: width 0.3s ease;"></div>
                </div>
            </header>
            
            <div id="quiz-card" class="p-6 sm:p-8 rounded-lg quiz-card pixel-border">
                <p id="question-text" class="text-lg sm:text-xl leading-normal mb-6 min-h-[100px] flex items-center justify-center text-center"></p>
                <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Options will be generated here -->
                </div>
                 <div class="mt-6 text-right">
                    <button id="manual-next-btn" class="hidden action-btn text-white font-bold py-2 px-6 rounded-lg text-sm pixel-border">Lanjut</button>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden screen text-center p-8 rounded-lg max-w-lg w-full pixel-border bg-[#fca444]">
            <h2 class="text-3xl font-bold mb-4">Permainan Selesai!</h2>
            <p class="text-lg text-white mb-2">Skor Akhir:</p>
            <p id="final-score" class="text-7xl font-bold my-4"></p>
            <p id="final-feedback" class="text-sm mb-8 leading-relaxed"></p>
            <button id="retry-btn" class="w-full action-btn text-white font-bold py-4 px-8 rounded-lg text-xl pixel-border">
                Coba Lagi
            </button>
        </div>

         <!-- Loading Overlay for TTS -->
        <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-75 flex flex-col justify-center items-center z-50">
            <p id="loading-text" class="text-2xl text-white">Memuat Suara...</p>
        </div>

    </div>
    <audio id="tts-audio" style="display: none;"></audio>

    <script>
        const quizData = [
            { question: "Bagian struktur mana yang merupakan fungsional terkecil yang menyusun tubuh manusia?", options: ["Atom", "Molekul", "Sel", "Jaringan", "Organ"], answer: "Sel" },
            { question: "Tokoh yang dikenal sebagai 'reformer of Anatomy' adalah...", options: ["John Hunter", "Claudius Galen", "William Harvey", "Andreus Vesalius", "Alfarabi"], answer: "Andreus Vesalius" },
            { question: "Enzim yang berperan dalam proses glikolisis di sitosol termasuk dalam kategori makromolekul...", options: ["Karbohidrat", "Lipid", "Protein", "Asam Nukleat", "Polisakarida"], answer: "Protein" },
            { question: "Retikulum sarkoplasma pada sel otot menyimpan dan mengeluarkan ion yang berperan dalam kontraksi otot. Ion yang dimaksud adalah...", options: ["Na+", "Ca2+", "K+", "O2-", "Cl-"], answer: "Ca2+" },
            { question: "Organel sel yang berfungsi sebagai 'jalan raya seluler' untuk pergerakan vesikel sekretori adalah...", options: ["Mikrofilamen", "Filamen intermediet", "Mikrotubulus", "Ribosom", "Lisosom"], answer: "Mikrotubulus" },
            { question: "Enzim yang berperan penting dalam menyalin urutan DNA menjadi mRNA selama proses transkripsi adalah...", options: ["Helicase", "DNA polimerase", "RNA polimerase", "Ligase", "Gyrase"], answer: "RNA polimerase" },
            { question: "Lisosom merupakan organel digestif. Proses di mana sel menelan partikel besar seperti bakteri disebut...", options: ["Endositosis", "Eksositosis", "Fagositosis", "Autofagi", "Pinocytosis"], answer: "Fagositosis" },
            { question: "Seorang pasien mengalami gangguan pada sintesis protein. Pemeriksaan mikroskopis kemungkinan besar akan menunjukkan kelainan pada organel...", options: ["Mitokondria", "Aparatus Golgi", "Retikulum Endoplasma Kasar", "Retikulum Endoplasma Halus", "Lisosom"], answer: "Retikulum Endoplasma Kasar" },
            { question: "Peran utama kolesterol pada membran sel adalah...", options: ["Meningkatkan fluiditas membran", "Mengatur fluiditas membran", "Meningkatkan laju difusi", "Memadatkan membran sel", "Membentuk kanal ion"], answer: "Mengatur fluiditas membran" },
            { question: "Proses metabolisme pemecahan glukosa menjadi piruvat yang terjadi di sitosol adalah...", options: ["Siklus Krebs", "Fosforilasi Oksidatif", "Glikolisis", "Glikogenesis", "Fotosintesis"], answer: "Glikolisis" },
            { question: "Sel-sel hati (hepar) sangat aktif dalam menetralisir racun seperti alkohol. Organel yang paling berperan dalam proses detoksifikasi ini adalah...", options: ["Mitokondria", "Aparatus Golgi", "Retikulum Endoplasma Kasar", "Retikulum Endoplasma Halus", "Peroksisom"], answer: "Retikulum Endoplasma Halus" },
            { question: "Regio olecranon berada pada...", options: ["Lutut", "Siku", "Leher", "Punggung", "Paha"], answer: "Siku" },
            { question: "Gerakan tangan mengarah telapak ke bawah disebut pronasi, dan gerakan kaki mendekati tulang kering disebut...", options: ["Supinasi dan Dorsofleksi", "Pronasi dan Plantarfleksi", "Pronasi dan Dorsofleksi", "Supinasi dan Plantarfleksi", "Pronasi dan Inversi"], answer: "Pronasi dan Dorsofleksi" },
            { question: "Protein motorik yang bergerak menjauhi pusat sel (MTOC) sambil membawa vesikula adalah...", options: ["Aktin", "Fibrilin", "Dynein", "Kinesin", "Myosin"], answer: "Kinesin" },
            { question: "Tempat penyimpanan utama glikogen pada tubuh manusia adalah...", options: ["Tulang", "Pankreas", "Paru-paru", "Jantung", "Otot"], answer: "Otot" },
            { question: "Jenis pembuluh darah besar yang mengandung banyak serat elastin untuk menahan tekanan tinggi adalah...", options: ["Aorta", "Arteri pulmonalis", "Vena", "Arteri koronalis", "Vena kava"], answer: "Aorta" },
            { question: "Nama protein yang berperan membantu pelipatan rantai polipeptida agar fungsional adalah...", options: ["Chaperone", "Spliceosome", "Lisosom", "Ligase", "Metionin"], answer: "Chaperone" },
            { question: "Konsentrasi ion manakah yang secara normal lebih tinggi di dalam cairan intraseluler dibandingkan ekstraseluler?", options: ["Mg2+", "Cl-", "K+", "Ca2+", "Na+"], answer: "K+" },
            { question: "Zat yang dihasilkan pada peroksisom yang bersifat racun dan kemudian diuraikan oleh enzim katalase adalah...", options: ["Hidrogen Peroksida", "Karbon dioksida", "Oksigen", "Asam laktat", "Asetaldehida"], answer: "Hidrogen Peroksida" },
            { question: "Manakah dari senyawa organik berikut yang BUKAN merupakan polimer?", options: ["Lipid", "Karbohidrat (polisakarida)", "Asam nukleat", "Protein", "Semua adalah polimer"], answer: "Lipid" },
            { question: "Ciri yang dapat membantu identifikasi pembuluh limfatik pada kadaver adalah...", options: ["Struktur seperti pipa yang kaku", "Struktur berlumen dan tebal", "Struktur seperti pipa kempes, transparan dan berkelok-kelok", "Struktur seperti pipa darah yang menggerombol", "Berwarna merah cerah"], answer: "Struktur seperti pipa kempes, transparan dan berkelok-kelok" },
            { question: "Endositosis, proses sel memasukkan zat ke dalam dengan melipat membran, termasuk dalam kategori...", options: ["Transpor aktif", "Difusi sederhana", "Transpor pasif", "Difusi difasilitasi", "Osmosis"], answer: "Transpor aktif" },
            { question: "Ribosom yang menempel pada REK berfungsi dalam sintesis protein yang ditujukan untuk...", options: ["Digunakan di dalam sitosol saja", "Menyusun membran dan untuk sekresi", "Produksi energi seluler", "Hanya untuk perbaikan DNA", "Detoksifikasi sel"], answer: "Menyusun membran dan untuk sekresi" },
            { question: "Bidang sagital yang berada pada bagian depan ketiak sebelah kanan disebut...", options: ["Linea axillaris anterior dexter", "Linea midaxillaris dexter", "Linea midscapularis dexter", "Linea midclavicularis dexter", "Linea parasternalis dexter"], answer: "Linea axillaris anterior dexter" },
            { question: "Mengapa larutan isotonik digunakan untuk infus pada pasien?", options: ["Menyebabkan plasmolisis sel", "Tekanan osmotiknya sesuai dengan cairan dalam sel tubuh", "Meningkatkan tekanan osmotik sel", "Memberikan efek detoksifikasi", "Memberikan energi tambahan"], answer: "Tekanan osmotiknya sesuai dengan cairan dalam sel tubuh" },
            { question: "Fungsi utama epitel transisional yang melapisi kandung kemih adalah...", options: ["Menghasilkan lendir pelindung", "Membentuk silia untuk pergerakan urin", "Meningkatkan sekresi urin", "Dapat meregang untuk mengakomodasi perubahan volume", "Menyerap kembali air dari urin"], answer: "Dapat meregang untuk mengakomodasi perubahan volume" },
            { question: "Kelenjar yang melepaskan produknya (hormon) langsung ke aliran darah tanpa melalui duktus/saluran adalah...", options: ["Endokrin", "Eksokrin", "Merokrin", "Holokrin", "Apokrin"], answer: "Endokrin" },
            { question: "Diseksi pada kadaver yang dapat ditonton oleh masyarakat umum terjadi pada periode...", options: ["Periode Yunani", "Periode Romawi", "Abad Pertengahan", "Periode Renaisans", "Abad ke-14 SM"], answer: "Periode Renaisans" },
            { question: "Di antara regio tubuh berikut, manakah yang terletak paling distal?", options: ["Regio coxae", "Regio cruris", "Regio patellaris", "Regio digiti pedis", "Regio poplitea"], answer: "Regio digiti pedis" },
            { question: "Glukosa yang sudah terserap oleh mukosa intestinum tidak bisa kembali ke lumen karena terdapat...", options: ["Tight junction", "Hemidesmosom", "Desmosom", "Gap junction", "Adherens junction"], answer: "Tight junction" },
            { question: "Fungsi dari enzim topoisomerase dalam replikasi DNA adalah...", options: ["Mengikat situs origin", "Menghilangkan tegangan superkoil DNA", "Bergabung dengan fragmen Okazaki", "Memutus ikatan hidrogen", "Menyambung untai DNA"], answer: "Menghilangkan tegangan superkoil DNA" },
            { question: "Modifikasi protein seperti penambahan molekul karbohidrat (glikosilasi) terjadi pada kompleks golgi bagian...", options: ["Entry face (cis)", "Medial cisternae", "Exit face (trans)", "Vesikel transpor", "Lumen REK"], answer: "Medial cisternae" },
            { question: "Proses denaturasi protein adalah ketika protein...", options: ["Kehilangan struktur tiga dimensinya dan menjadi tidak aktif", "Mendapat struktur sekunder baru", "Disintesis dalam jumlah lebih banyak", "Didegradasi menjadi asam amino", "Menjadi lebih mudah larut dalam air"], answer: "Kehilangan struktur tiga dimensinya dan menjadi tidak aktif" },
            { question: "Proses 'mRNA capping' pada modifikasi pasca-transkripsi adalah...", options: ["Penambahan ekor poli-A pada ujung 3'", "Penambahan 7-metilguanosin pada ujung 5'", "Penghilangan intron dari mRNA", "Penambahan 7-metilguanosin pada ujung 3'", "Penambahan ekor poli-A pada ujung 5'"], answer: "Penambahan 7-metilguanosin pada ujung 5'" },
            { question: "Struktur utama penyusun sitosol (fraksi cair dari sitoplasma) adalah...", options: ["Karbohidrat", "Protein", "Asam lemak", "Mineral", "Air"], answer: "Air" },
            { question: "Manakah pernyataan yang benar mengenai sel eukariot?", options: ["Organel sel tidak mempunyai membran", "Memiliki organel terikat membran seperti mitokondria", "Contohnya adalah Bakteri dan alga biru-hijau", "Dinding selnya dari peptidoglikan", "Tidak memiliki sitoskeleton"], answer: "Memiliki organel terikat membran seperti mitokondria" },
            { question: "Kelenjar susu melepaskan sekresinya dengan cara melepaskan sebagian sitoplasmanya. Mekanisme sekresi ini disebut...", options: ["Hemokrin", "Holokrin", "Apokrin", "Merokrin", "Endokrin"], answer: "Apokrin" },
            { question: "Pengambilan kolesterol LDL dari darah ke dalam sel hati adalah contoh dari...", options: ["Fagositosis", "Pinocytosis", "Receptor-mediated endocytosis", "Eksositosis", "Difusi sederhana"], answer: "Receptor-mediated endocytosis" },
            { question: "Fungsi proteoglikan dalam matriks jaringan kartilago (tulang rawan) adalah...", options: ["Meningkatkan kekakuan tulang", "Memberikan elastisitas dan ketahanan terhadap tekanan", "Mempercepat pertumbuhan tulang", "Meningkatkan produksi kolagen", "Menyimpan kalsium"], answer: "Memberikan elastisitas dan ketahanan terhadap tekanan" },
            { question: "Bagaimana 'tight junction' mengintegrasikan sel-sel epitel menjadi satu lapisan fungsional?", options: ["Membuat jarak untuk difusi", "Menghubungkan sitoplasma untuk nutrisi", "Menyegel ruang antarsel untuk mencegah kebocoran", "Menempelkan sel ke membran basal", "Hanya berfungsi pada temperatur tinggi"], answer: "Menyegel ruang antarsel untuk mencegah kebocoran" },
            { question: "Struktur protein yang terbentuk dari gabungan dua atau lebih rantai polipeptida disebut struktur...", options: ["Primer", "Sekunder", "Tersier", "Kuaterner", "Gamma"], answer: "Kuaterner" },
            { question: "Hemoglobin, yang terdiri dari empat subunit polipeptida, adalah contoh protein dengan struktur...", options: ["Primer", "Sekunder", "Tersier", "Kuaterner", "Semua salah"], answer: "Kuaterner" },
            { question: "Ikatan yang menghubungkan nukleotida dalam satu untai DNA atau RNA (ikatan gula-fosfat) adalah...", options: ["Ikatan hidrogen", "Ikatan ionik", "Ikatan fosfodiester", "Ikatan peptida", "Ikatan vanderwalls"], answer: "Ikatan fosfodiester" },
            { question: "Jika satu benang DNA memiliki urutan basa 20A, 25G, 30C, dan 22T, maka dalam benang-ganda lengkap DNA akan terdapat...", options: ["20A, 25G, 30C, 22T", "42A, 55G, 55C, 42T", "45A, 52G, 52C, 45T", "50A, 47G, 47C, 50T", "Jumlahnya tidak dapat ditentukan"], answer: "42A, 55G, 55C, 42T" },
            { question: "Komponen yang membentuk struktur dasar dwilapis (bilayer) pada membran sel adalah...", options: ["Karbohidrat", "Protein", "Fosfolipid", "Kolesterol", "Asam nukleat"], answer: "Fosfolipid" },
            { question: "Osmosis adalah perpindahan...", options: ["Zat pelarut dari konsentrasi pelarut tinggi ke rendah", "Zat pelarut dari konsentrasi pelarut rendah ke tinggi", "Zat terlarut dari konsentrasi terlarut tinggi ke rendah", "Zat terlarut dari konsentrasi terlarut rendah ke tinggi", "Air dan zat terlarut bersamaan"], answer: "Zat pelarut dari konsentrasi pelarut tinggi ke rendah" },
            { question: "Struktur utama yang membentuk lamina basalis, tempat epitel menempel, adalah...", options: ["Mikrofilamen", "Laminin", "Integrin", "Kolagen Tipe IV", "Fibrilin"], answer: "Kolagen Tipe IV" },
            { question: "Sitoskeleton yang berperan penting dalam kontraksi otot adalah...", options: ["Mikrofilamen (Aktin)", "Kinesin", "Filamen intermediet", "Mikrotubulus", "Dynein"], answer: "Mikrofilamen (Aktin)" },
            { question: "Bidang imajiner yang membagi tubuh menjadi bagian anterior dan posterior adalah...", options: ["Planum Sagitalis", "Planum Coronalis/Frontalis", "Planum Transversalis", "Planum Horizontalis", "Planum Midsagitalis"], answer: "Planum Coronalis/Frontalis" },
            { question: "Membrana serosa yang melapisi permukaan luar (bagian dalam) paru-paru adalah...", options: ["Perikardium parietalis", "Pleura parietalis", "Peritoneum parietalis", "Pleura visceralis", "Peritoneum visceralis"], answer: "Pleura visceralis" },
            { question: "Pada ribosom, situs ___ menampung tRNA yang membawa rantai polipeptida yang sedang tumbuh, sedangkan situs ___ menampung tRNA yang membawa asam amino berikutnya.", options: ["A, P", "P, A", "E, P", "P, E", "A, E"], answer: "P, A" },
            { question: "Struktur utama penyusun sel secara keseluruhan berdasarkan massa (setelah air) adalah...", options: ["Protein", "Lipid", "Karbohidrat", "Asam Nukleat", "Mineral"], answer: "Protein" },
            { question: "Yang BUKAN merupakan proses modifikasi protein setelah translasi adalah...", options: ["Trimming", "Glikosilasi", "Perubahan ikatan kovalen", "Protein folding", "Metilasi DNA"], answer: "Metilasi DNA" },
            { question: "Proses penerimaan sinyal kimia oleh reseptor di membran sel yang kemudian diubah menjadi respon seluler disebut...", options: ["Difusi pasif", "Transpor aktif", "Endositosis", "Transduksi sinyal", "Potensial aksi"], answer: "Transduksi sinyal" },
            { question: "Organel yang berfungsi sebagai 'pusat penerimaan dan pengiriman' produk sel, memodifikasi, menyortir, dan membungkus protein adalah...", options: ["Mitokondria", "Badan Golgi", "RE Kasar", "RE Halus", "Lisosom"], answer: "Badan Golgi" },
            { question: "Struktur khusus untuk pengecapan rasa yang terdapat pada papila lidah adalah...", options: ["Mikrovili", "Taste bud", "Epitel olfaktori", "Sel rambut", "Stereosilia"], answer: "Taste bud" },
            { question: "Mikrovili, yang berfungsi untuk memperluas area permukaan sel, merupakan tonjolan sitoplasma yang diperkuat oleh sitoskeleton jenis...", options: ["Filamen intermediet", "Lamin", "Keratin", "Mikrotubulus", "Mikrofilamen"], answer: "Mikrofilamen" },
            { question: "Jika terjadi mutasi pada protein kinesin, maka transpor vesikel akan terganggu terutama pada pergerakan...", options: ["Menuju pusat sel", "Menjauhi pusat sel", "Antar mitokondria", "Keluar dari badan Golgi", "Masuk ke nukleus"], answer: "Menjauhi pusat sel" },
            { question: "Penyakit sel sabit (sickle cell) disebabkan oleh...", options: ["Kelebihan kapasitas oksigen pada hemoglobin", "Mutasi pada gen yang mengkode subunit hemoglobin", "Peningkatan jumlah total hemoglobin", "Perbedaan pada struktur sekunder hemoglobin", "Faktor lingkungan, bukan genetik"], answer: "Mutasi pada gen yang mengkode subunit hemoglobin" },
            { question: "Manakah yang termasuk proses transpor aktif primer?", options: ["Difusi sederhana", "Difusi terfasilitasi", "Pompa natrium-kalium", "Osmosis", "Endositosis"], answer: "Pompa natrium-kalium" },
            { question: "Fungsi utama glikoprotein pada permukaan membran sel adalah...", options: ["Menyusun struktur dasar membran", "Mengatur fluiditas membran", "Pengenalan dan komunikasi antar sel", "Penyimpanan energi", "Sintesis lipid"], answer: "Pengenalan dan komunikasi antar sel" },
            { question: "Manakah pernyataan yang paling akurat mengenai lokasi DNA dan RNA dalam sel eukariotik?", options: ["DNA hanya di nukleus, RNA hanya di sitoplasma", "Keduanya hanya ada di nucleus", "DNA di nukleus, RNA di nukleus dan sitoplasma", "DNA di nukleus dan mitokondria, RNA di nukleus, sitoplasma, dan ribosom", "Keduanya hanya ada di sitoplasma"], answer: "DNA di nukleus dan mitokondria, RNA di nukleus, sitoplasma, dan ribosom" },
            { question: "Bidang yang membagi tubuh menjadi bagian kanan dan kiri adalah...", options: ["Sagital", "Transversal", "Coronal", "Frontal", "Horizontal"], answer: "Sagital" },
            { question: "Pernyataan yang benar mengenai fagositosis oleh sel makrofag adalah...", options: ["Tidak berpengaruh pada sistem imun", "Proses melepaskan senyawa untuk menarik bakteri", "Proses menelan dan mencerna patogen atau sel mati", "Hanya terjadi di aliran darah", "Merupakan bagian dari imunitas adaptif"], answer: "Proses menelan dan mencerna patogen atau sel mati" }
        ];

        // Elements
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const startBtn = document.getElementById('start-btn');
        const retryBtn = document.getElementById('retry-btn');
        const surrenderBtn = document.getElementById('surrender-btn');
        const nameInput = document.getElementById('name-input');
        const ttsAudio = document.getElementById('tts-audio');
        const loadingOverlay = document.getElementById('loading-overlay');
        const currentQNumEl = document.getElementById('current-question-num');
        const totalQEl = document.getElementById('total-questions');
        const scoreEl = document.getElementById('score');
        const progressBar = document.getElementById('progress-bar');
        const quizTimerEl = document.getElementById('quiz-timer');
        const quizCard = document.getElementById('quiz-card');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const manualNextBtn = document.getElementById('manual-next-btn');
        const finalScoreEl = document.getElementById('final-score');
        const finalFeedbackEl = document.getElementById('final-feedback');
        
        // --- TTS and API Configuration ---
        const TTS_API_KEY = "2bca63c883a0455cbdba6a251782cb9f";


        // --- State ---
        let currentQuestionIndex = 0;
        let score = 0;
        let shuffledQuestions = [];
        let quizTimerInterval;
        let totalTime;
        let autoNextTimeout;
        let userName = '';

        // --- TTS Helper Function ---
        function generateAndPlayAudio(text) {
            loadingOverlay.classList.remove('hidden');

            const params = new URLSearchParams({
                key: TTS_API_KEY,
                src: text,
                hl: 'id-id', // Indonesian
                v: 'Dini',    // Indonesian Female Voice
                r: '0',       // Normal rate
                c: 'MP3',
                f: '44khz_16bit_stereo',
                b64: 'false'
            });

            const ttsUrl = `https://api.voicerss.org/?${params.toString()}`;

            ttsAudio.src = ttsUrl;
            ttsAudio.play().catch(e => {
                console.error("Audio playback failed:", e);
                loadingOverlay.classList.add('hidden');
            });

            ttsAudio.oncanplaythrough = () => {
                loadingOverlay.classList.add('hidden');
            };
            ttsAudio.onerror = () => {
                loadingOverlay.classList.add('hidden');
                console.error("Failed to load TTS audio.");
            };
        }

        // --- Game Logic Functions ---
        function startGame() {
            userName = nameInput.value.trim() || 'Anak Bawang';
            
            startScreen.classList.add('hidden');
            
            const greetingText = `Halo ${userName}, otak udang! Cepat sujud sama Robin, yang paling ganteng sedunia, atau ku buat kau jadi preparat!`;
            generateAndPlayAudio(greetingText);

            resultsScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');

            currentQuestionIndex = 0;
            score = 0;
            shuffledQuestions = [...quizData].sort(() => Math.random() - 0.5);
            totalQEl.textContent = shuffledQuestions.length;
            totalTime = 3600; // 1 hour in seconds
            
            startQuizTimer();
            showQuestion();
            updateScore();
        }

        function startQuizTimer() {
            quizTimerEl.textContent = "60:00";
            if(quizTimerInterval) clearInterval(quizTimerInterval);

            quizTimerInterval = setInterval(() => {
                totalTime--;
                const minutes = Math.floor(totalTime / 60).toString().padStart(2, '0');
                const seconds = (totalTime % 60).toString().padStart(2, '0');
                quizTimerEl.textContent = `${minutes}:${seconds}`;

                if (totalTime <= 0) {
                    clearInterval(quizTimerInterval);
                    showResults(false);
                }
            }, 1000);
        }

        function showQuestion() {
            resetState();
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            
            quizCard.classList.add('question-transition-in');
            currentQNumEl.textContent = currentQuestionIndex + 1;
            questionTextEl.textContent = currentQuestion.question;
            progressBar.style.width = `${((currentQuestionIndex + 1) / shuffledQuestions.length) * 100}%`;

            const optionSymbols = ['ðŸ„', 'â­', 'ðŸŒ¸', 'â˜ï¸', 'ðŸ¢'];
            
            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.classList.add('option-btn', 'p-4', 'rounded-lg', 'text-left', 'w-full', 'text-sm', 'md:text-base');
                button.innerHTML = `<span class="inline-block w-6 text-center mr-2">${optionSymbols[index % 5]}</span><span>${option}</span>`;
                button.dataset.answer = option;
                optionsContainer.appendChild(button);
                button.addEventListener('click', selectAnswer);
            });
        }
        
        function resetState(){
            clearTimeout(autoNextTimeout);
            manualNextBtn.classList.add('hidden');
            quizCard.classList.remove('question-transition-in');
            while(optionsContainer.firstChild){
                optionsContainer.removeChild(optionsContainer.firstChild);
            }
        }
        
        function selectAnswer(e) {
            const selectedBtn = e.currentTarget;
            showFeedback(selectedBtn);
        }
        
        function showFeedback(selectedBtn) {
            const correctAnswer = shuffledQuestions[currentQuestionIndex].answer;
            const isCorrect = selectedBtn && selectedBtn.dataset.answer === correctAnswer;

            if (isCorrect) {
                score += 10;
                selectedBtn.classList.add('correct');
            } else if (selectedBtn) {
                selectedBtn.classList.add('incorrect');
            }
            
            Array.from(optionsContainer.children).forEach(button => {
                if (button.dataset.answer === correctAnswer) {
                    button.classList.add('correct');
                }
                button.classList.add('disabled');
            });
            
            updateScore();
            manualNextBtn.classList.remove('hidden');
            autoNextTimeout = setTimeout(showNextQuestion, 2000);
        }

        function handleManualNext() {
            clearTimeout(autoNextTimeout);
            showNextQuestion();
        }

        function showNextQuestion() {
            currentQuestionIndex++;
            quizCard.classList.add('question-transition-out');
            
            setTimeout(() => {
                 if (currentQuestionIndex < shuffledQuestions.length) {
                    quizCard.classList.remove('question-transition-out');
                    showQuestion();
                } else {
                    showResults(false);
                }
            }, 300);
        }
        
        function updateScore() {
            scoreEl.textContent = score;
        }

        function showResults(surrendered = false) {
            clearInterval(quizTimerInterval);
            quizScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');

            const correctAnswers = score / 10;
            const totalQuestions = shuffledQuestions.length;
            const scorePercentage = totalQuestions > 0 ? (correctAnswers / totalQuestions) * 100 : 0;
            
            finalScoreEl.textContent = `${score}`;
            
            let feedbackText, ttsText;
            if (surrendered) {
                feedbackText = `Payah! Baru segitu udah nyerah, ${userName}!`;
                ttsText = `Kamu noob anjing, ${userName}!`;
            } else {
                feedbackText = `Anda menjawab ${correctAnswers} dari ${totalQuestions} soal dengan benar. (${scorePercentage.toFixed(1)}%)`;
                ttsText = `Kerja bagus, ${userName}! Skor segitu lumayan lah. Jangan lupa istirahat, terus belajar lagi biar makin jago!`;
            }
            finalFeedbackEl.textContent = feedbackText;
            generateAndPlayAudio(ttsText);
        }

        startBtn.addEventListener('click', startGame);
        retryBtn.addEventListener('click', () => {
             // Go back to start screen to allow name change
             resultsScreen.classList.add('hidden');
             startScreen.classList.remove('hidden');
        });
        manualNextBtn.addEventListener('click', handleManualNext);
        surrenderBtn.addEventListener('click', () => showResults(true));

    </script>
</body>
</html>

